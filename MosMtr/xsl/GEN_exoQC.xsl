<?xml version="1.0" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"><xsl:variable name="typeQC"><xsl:choose><xsl:when test="/exo/@multiple='1'">QCM</xsl:when><xsl:otherwise>QCU</xsl:otherwise></xsl:choose></xsl:variable><xsl:variable name="formatBtn"><xsl:call-template name="FORMAT_BOUTON"/></xsl:variable><xsl:variable name="decalY"><xsl:if test="(count(/exo/reponses/reponse)+number(/exo/@score))mod 2 = 1">1</xsl:if></xsl:variable><xsl:variable name="marges"><xsl:choose><xsl:when test="/exo/@marges!=''"><xsl:value-of select="/exo/@marges"/></xsl:when><xsl:otherwise>12</xsl:otherwise></xsl:choose></xsl:variable><xsl:template name="JSCRIPT_CSS_QC"><xsl:call-template name="JSCRIPT_CSS_EXO"/><script type="text/javascript" src="../../MosMtr/scripts/contenu/ClasseExerciceQC.js"></script><script type="text/javascript">var afficheBordure=false;function entrerDonnees(){ exo = new ExerciceQC("<xsl:value-of select="$typeQC"/>");exo.init();exo.scoreTotal=<xsl:value-of select="exo/@score"/>;<xsl:for-each select="exo/reponses/reponse"><xsl:sort select="text()" order="descending"/>var oItem=new ItemReponse('<xsl:value-of select="translate(@id,'0123789','3879102')"/>');oItem.init("<xsl:value-of select="position()"/><xsl:choose><xsl:when test="$decalY='1'"><xsl:choose><xsl:when test="not(@styleR='nw')">1</xsl:when><xsl:otherwise>2</xsl:otherwise></xsl:choose></xsl:when><xsl:otherwise><xsl:choose><xsl:when test="@styleR='nw'">1</xsl:when><xsl:otherwise>2</xsl:otherwise></xsl:choose></xsl:otherwise></xsl:choose>","<xsl:value-of select="@prerequis"/>","<xsl:value-of select="@poids"/>","<xsl:value-of select="@objectif"/>");exo.tabItems[exo.tabItems.length]=oItem;</xsl:for-each><xsl:if test="exo/@ordreAleatoire='oui'">exo.ordreAleatoire=true;</xsl:if><xsl:if test="exo/@boutonsRep='non'">exo.afficheBoutons=false;</xsl:if>exo.maxSel='<xsl:value-of select="exo/@maxSel"/>';<xsl:if test="exo/@afficheBordure='true'">afficheBordure=true;</xsl:if><xsl:if test="exo/@poidsEnPoints='oui'">exo.poidsEnPoints=true;</xsl:if><xsl:call-template name="AFFECTE_INTERACTIONS"/>}</script></xsl:template> <xsl:template match="exo/reponses"><xsl:choose><xsl:when test="/exo/@disposition='grille'"><xsl:variable name="nbColones"><xsl:choose><xsl:when test="/exo/@grilleX"><xsl:value-of select="/*/@grilleX"/></xsl:when><xsl:otherwise>3</xsl:otherwise></xsl:choose></xsl:variable><table cellpadding="0" cellspacing="{$marges}"><xsl:if test="/exo/@supprimeMarge='oui'"><xsl:attribute name="cellspacing">0</xsl:attribute></xsl:if><xsl:if test="not($nbColones=50)"><xsl:attribute name="align">center</xsl:attribute></xsl:if><xsl:choose><xsl:when test="$nbColones='1'"><xsl:for-each select="reponse"><tr><xsl:apply-templates select="." mode="tab"/></tr></xsl:for-each></xsl:when><xsl:otherwise><xsl:for-each select="reponse"><xsl:if test="(position() = 1) or ((position() mod $nbColones) = 1)"><tr><xsl:apply-templates select="." mode="tab"/><xsl:apply-templates select="following-sibling::reponse[position() &lt; $nbColones]" mode="tab"/></tr></xsl:if></xsl:for-each></xsl:otherwise></xsl:choose></table></xsl:when><xsl:otherwise><table cellspacing="1" cellpadding="0" class="STY_listeQC"><xsl:if test="$marges='0'"><xsl:attribute name="cellspacing">0</xsl:attribute></xsl:if><xsl:for-each select="reponse"><xsl:apply-templates select="." mode="liste"/></xsl:for-each></table></xsl:otherwise></xsl:choose></xsl:template><xsl:template match="reponses/reponse" mode="liste"><xsl:call-template name="GEN_REP"/></xsl:template><xsl:template match="reponses/reponse" mode="tab"><xsl:variable name="num"><xsl:number/></xsl:variable><td valign="top"><xsl:if test="not(/exo/@grilleX=50)"><xsl:attribute name="width"><xsl:value-of select="100 div /exo/@grilleX"/>%</xsl:attribute></xsl:if><table width="100%" cellpadding="0"><xsl:if test="$marges='0' or $marges='1'"><xsl:attribute name="cellspacing">0</xsl:attribute></xsl:if><xsl:call-template name="GEN_REP"/></table></td></xsl:template><xsl:template name="GEN_REP"><tr id="trRep{@id}"><xsl:if test="/exo/@boutonsDisp='droite'"><td valign="top" class="STY_bordureQC" id="tdRep{@id}"><div class="STY_reponseQC" id="lien{@id}" onmouseover="exo.changerBouton('{@id}',true)" onmouseout="exo.changerBouton('{@id}',false)" onclick="exo.action('{@id}')"><xsl:apply-templates/></div></td></xsl:if><xsl:if test="not(starts-with(/exo/@boutonsRep,'non'))"><td align="right" width="20" valign="middle"><xsl:if test="/exo/@boutonsRep and /exo/@boutonsRep!=''"><xsl:attribute name="valign"><xsl:value-of select="/exo/@boutonsRep"/></xsl:attribute></xsl:if><img class="STY_imgBoutonQC" onmouseover="if(exo)exo.changerBouton('{@id}',true);" onmouseout="exo.changerBouton('{@id}',false)" onclick="exo.action('{@id}')" id="boutonRep{@id}" src="../../MosMtr/ressources/style/media/gen/bouton{$typeQC}.{$formatBtn}"><xsl:if test="/exo/@boutonsRep='middle'"><xsl:attribute name="vspace">1</xsl:attribute></xsl:if></img></td></xsl:if><xsl:if test="not(/exo/@boutonsDisp='droite')"><td valign="top" class="STY_bordureQC" id="tdRep{@id}"><xsl:if test="$marges='0'"><xsl:attribute name="style">padding:0px</xsl:attribute></xsl:if><div class="STY_reponseQC" id="lien{@id}" onmouseover="if(exo)exo.changerBouton('{@id}',true)" onmouseout="if(exo)exo.changerBouton('{@id}',false)" onclick="exo.action('{@id}')"><xsl:if test="$marges='0'"><xsl:attribute name="style">padding:0px</xsl:attribute></xsl:if><xsl:apply-templates/></div></td></xsl:if></tr></xsl:template></xsl:stylesheet>
