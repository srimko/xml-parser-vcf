<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"> <xsl:import href="../../../../../../../../MosGnr/xsl/export/GEN_vImprim.xsl" /> <xsl:template name="cours"> <xsl:if test="cours/texte/* or cours/texte/text()"> <div class="STY_texteCours"> <xsl:if test="count(cours/commentaires/commentaire) &gt;2"><xsl:attribute name="style">min-height:550px;_height:550px</xsl:attribute></xsl:if> <xsl:if test="cours/commentaires/commentaire//img"><xsl:attribute name="style">min-height:350px;_height:350px</xsl:attribute></xsl:if> <xsl:apply-templates select="cours/texte" /> </div></xsl:if> <xsl:if test="cours/commentaires/commentaire"> <div class="STY_zoneCommentaire"> <xsl:call-template name="COMMENTAIRES" /> </div> </xsl:if> </xsl:template> <xsl:template match="/"> <xsl:call-template name="ENTETE_PAGE" /> <xsl:call-template name="STYLE_contenu" /> <xsl:call-template name="cours" /> <xsl:call-template name="BAS_PAGE" /> </xsl:template> <xsl:template name="COMMENTAIRES"> <xsl:variable name="nbColones"><xsl:choose><xsl:when test="count(cours/commentaires/commentaire)&lt;2 or cours/commentaires/commentaire//img[@width &gt; 250]">1</xsl:when><xsl:otherwise>2</xsl:otherwise></xsl:choose> </xsl:variable> <table cellpadding="0" cellspacing="0" width="100%" align="center"> <xsl:for-each select="cours/commentaires/commentaire"> <xsl:choose> <xsl:when test="$nbColones=1"> <tr> <xsl:apply-templates select="." /> </tr> </xsl:when> <xsl:otherwise> <xsl:if test="(position() = 1) or ((position() mod $nbColones) = 1)"> <tr> <xsl:apply-templates select="." /> <xsl:apply-templates select="following-sibling::commentaire[position() &lt; $nbColones]" /> </tr> </xsl:if> </xsl:otherwise> </xsl:choose> </xsl:for-each> </table> </xsl:template> <xsl:template match="cours//commentaire"> <td class="STY_commentaire" valign="top"> <div class="STY_comtTitre"> <xsl:if test=".//img or .//clipAV"><xsl:attribute name="style">display:block;margin-bottom:3px</xsl:attribute></xsl:if> <xsl:value-of select="@num" />.Â <xsl:value-of select="@titre" /><xsl:if test="@titre and @titre!='' and not(p or div or img or clipAV or table)">.</xsl:if></div> <div class="STY_comtContenu"><xsl:apply-templates /></div> </td> </xsl:template></xsl:stylesheet>
