<?xml version="1.0" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"><xsl:variable name="typeQC"><xsl:choose><xsl:when test="starts-with(/exo/@multiple,'1')">QCM</xsl:when><xsl:otherwise>QCU</xsl:otherwise></xsl:choose></xsl:variable><xsl:variable name="formatBtn"><xsl:call-template name="FORMAT_BOUTON"/></xsl:variable><xsl:template name="JSCRIPT_CSS_QM"><xsl:call-template name="JSCRIPT_CSS_EXO"/><script type="text/javascript" src="../../MosMtr/scripts/contenu/ClasseExerciceQM.js"></script><script type="text/javascript">function entrerDonnees(){ exo = new ExerciceQM("<xsl:value-of select="$typeQC"/>");exo.init();exo.scoreTotal=<xsl:apply-templates select="exo/@score"/>;<xsl:if test="exo/@poidsEnPoints='oui'">exo.poidsEnPoints=true;</xsl:if><xsl:for-each select="exo/reponses/reponse"><xsl:sort select="text()" order="descending"/>var oItem=new ItemReponse('<xsl:value-of select="translate(@id,'0123789','3879102')"/>');oItem.init("<xsl:value-of select="translate(@styleR,'col01245789','rep57890124')"/>","<xsl:value-of select="@prerequis"/>","<xsl:value-of select="@poids"/>");exo.tabItems[exo.tabItems.length]=oItem;</xsl:for-each><xsl:for-each select="exo/colonesQM/coloneQM">exo.tabColonnes[exo.tabColonnes.length]="<xsl:value-of select="@id"/>";</xsl:for-each><xsl:if test="exo/@ordreAleatoire='oui'">exo.ordreAleatoire=true;</xsl:if><xsl:call-template name="AFFECTE_INTERACTIONS"/>}</script></xsl:template> <xsl:template match="exo/reponses"><table cellspacing="1" cellpadding="0" class="STY_tableauQM"><tr><xsl:if test="/exo/@boutonsDisp='droite'"><td></td></xsl:if><xsl:apply-templates select="/exo/colonesQM/coloneQM" mode="label"/><xsl:if test="/exo/@boutonsDisp!='droite'"><td></td></xsl:if></tr><xsl:apply-templates select="reponse" mode="liste"/></table></xsl:template><xsl:template match="reponses/reponse" mode="liste"><xsl:call-template name="GEN_REP"/></xsl:template><xsl:template name="GEN_REP"><tr id="trRep{@id}"><xsl:choose><xsl:when test="/exo/@boutonsDisp='droite'"><td valign="top" id="lien{@id}" class="STY_reponseQM"><xsl:apply-templates/></td><xsl:apply-templates select="//colonesQM/coloneQM" mode="boutons"><xsl:with-param name="numLigne"><xsl:value-of select="@id"/></xsl:with-param></xsl:apply-templates></xsl:when><xsl:otherwise><xsl:apply-templates select="//colonesQM/coloneQM" mode="boutons"><xsl:with-param name="numLigne"><xsl:value-of select="@id"/></xsl:with-param></xsl:apply-templates><td valign="top" id="lien{@id}" class="STY_reponseQM"><xsl:apply-templates/></td></xsl:otherwise></xsl:choose></tr></xsl:template><xsl:template match="coloneQM" mode="boutons"><xsl:param name="numLigne"/><td align="center"><xsl:attribute name="valign"><xsl:choose><xsl:when test="/exo/@boutonsRep"><xsl:value-of select="/exo/@boutonsRep"/></xsl:when><xsl:otherwise>middle</xsl:otherwise></xsl:choose></xsl:attribute><img class="STY_imgBoutonQM" onmouseover="if(exo)exo.changerBouton('{$numLigne}','{@id}',true);" onmouseout="if(exo)exo.changerBouton('{$numLigne}','{@id}',false)" onclick="exo.action('{$numLigne}','{@id}')" id="boutonRep{$numLigne}{@id}" src="../../MosMtr/ressources/style/media/gen/bouton{$typeQC}.{$formatBtn}"/></td></xsl:template><xsl:template match="coloneQM" mode="label"><td class="STY_coloneQM" id="{@id}"><xsl:value-of select="text()"/></td></xsl:template></xsl:stylesheet>
