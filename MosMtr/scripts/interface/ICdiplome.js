var nomComplet='';function DIPL_init(){PF_ecritDocW();PF_affecterAlt();var oFenSco=window.opener.parent;window.document.title=DIPL_donneTitreDiplome();PF_modifTexteDiv('STY_titreDIPL',DIPL_donneTitreDiplome());PF_modifTexteDiv('STY_nomUtilDIPL',DIPL_donneNomUtil());PF_modifTexteDiv('STY_idUtilDIPL',oFenSco.APIgetValue("cmi.learner_id"));nomComplet = oFenSco.donneNomUtilisateur();var tempsPasseDIPL=PF_donneObjet("STY_tempsPasseDIPL");if (tempsPasseDIPL){var tempsDiplome=0;if (oFenSco.temps_session!=""){tempsDiplome=oFenSco.intervalleEnMS(oFenSco.temps_session);}var tempTot=oFenSco.APIgetValue("cmi.total_time");if (tempTot!=""){tempsDiplome+=oFenSco.intervalleEnMS(tempTot);}if (tempsDiplome>0){tempTot=Math.ceil(tempsDiplome/60000);tempsPasseDIPL.innerHTML=tempTot;}}afficherInfosStagiaire();variablesTexte(window.document,tabRegVT());var oLib=PF_donneObjet('STY_libelleDIPL');if ((oLib!=null)&&(oLib.style.display="none")){PF_donneObjet('STY_libelleDIPL').style.display="";}}function tabRegVT(){var tabReg=new Array();tabReg[0]=new RegExp("\\[CMI_NAME\\]");tabReg[1]=new RegExp("\\[CMI_FIRSTNAME\\]");tabReg[2]=new RegExp("\\[pg\\w+\\('\\w*'\\)\\]");tabReg[3]=new RegExp("\\[LEX\\(\\d+\\)\\]");tabReg[4]=new RegExp("\\[SSP_VAR_[^\\]]+\\]");return tabReg;}function DIPL_donneNomUtil(){var nomComplet = window.opener.parent.donneNomUtilisateur();if (nomComplet==''){nomComplet='........................';}return nomComplet;}function afficherInfosStagiaire(){var libelle=DIPL_donneLibelleDiplome();if (libelle!=''){libelle=libelle.replace(/\n/g,'<br>');libelle=libelle.replace(/\\n/g,'<br>');PF_modifTexteDiv('STY_libelleDIPL',libelle);}}function DIPL_imprimer(){verStr=navigator.appVersion;if (verStr.indexOf("Mac") > 0) {alert(window.opener.donneLex(23));} else {PF_masquerDiv('STY_zoneNonImprimDIPL');window.print();}}function DIPL_modifierNom(){var nouveauN = prompt(window.opener.donneLex(44),nomComplet);if (nouveauN!=null){nomComplet=nouveauN;}PF_modifTexteDiv('STY_nomUtilDIPL',nomComplet);} function DIPL_donneTitreDiplome(){var res=window.opener.parent.oSco.evaluation.titreDiplome;if (res==''){res=window.opener.donneLex(42);}return res;}function donneLex(n){return window.opener.donneLex(n);}function DIPL_donneLibelleDiplome(){ var res=window.opener.parent.oSco.evaluation.libelleDiplome; return res;}function variablesTexte(obj,tabReg){var lesfils=obj.childNodes;for (var i=0;i<lesfils.length;i++){var oFils=lesfils.item(i);if (oFils.nodeType==3){var temp=oFils.nodeValue;if (temp.length>5){var modif=false;if (temp.match(tabReg[0])){temp=temp.replace(tabReg[0],donneNomU());modif=true;}if (temp.match(tabReg[1])){temp=temp.replace(tabReg[1],donnePrenomU());modif=true;}if (temp.match(tabReg[2])){var debut="";var fin=temp;var n=0;var offs=temp.search(tabReg[2]);while ((offs>=0)&&(n<20)){var tlemot=fin.match(tabReg[2]);var lemot=tlemot[0];debut+=fin.substring(0,offs);fin=fin.substring(lemot.length+offs);lemot=lemot.substring(1,lemot.length-1);lemot=lemot.replace(/pg(\w+)\(/g,"window.opener.parent.donneTextePre('pg$1',");try {lemot=eval(lemot);} catch(e){lemot="";}n++;offs=fin.search(tabReg[2]);debut+=lemot;}temp=debut+fin;modif=true;}if (temp.match(tabReg[3])){var debut="";var fin=temp;var n=0;var offs=temp.search(tabReg[3]);while (offs>=0 && n<20){var tlemot=fin.match(tabReg[3]);var lemot=tlemot[0];debut+=fin.substring(0,offs);fin=fin.substring(lemot.length+offs);lemot=lemot.substring(1,lemot.length-1);lemot=lemot.replace(/\LEX\(/g,"window.opener.parent.donneTexteLex(");try {lemot=eval(lemot);} catch(e){lemot="";}n++;offs=fin.search(tabReg[3]);debut+=lemot;}temp=debut+fin;modif=true;}if (temp.match(tabReg[4])){var debut="";var fin=temp;var n=0;var offs=temp.search(tabReg[4]);while (offs>=0 && n<20){var tlemot=fin.match(tabReg[4]);var lemot=tlemot[0];debut+=fin.substring(0,offs);fin=fin.substring(lemot.length+offs);lemot=lemot.substring(1,lemot.length-1);if (lemot.indexOf("SSP_VAR_U_")==0){lemot=window.opener.parent.SCO_donneAllocation(lemot.substring(10),"learner");} else if (lemot.indexOf("SSP_VAR_C_")==0){lemot=window.opener.parent.SCO_donneAllocation(lemot.substring(10),"course");}n++;offs=fin.search(tabReg[4]);debut+=lemot;}temp=debut+fin;modif=true;}if (modif){oFils.nodeValue=temp;}}} else if (oFils.nodeType==1){variablesTexte(oFils,tabReg);}}}function donnePrenomU(){var res='';var nom=window.opener.parent.APIgetValue("cmi.learner_name");var indexVirg=nom.indexOf(',');if (indexVirg>0){res=nom.substring(indexVirg+1);} return res;}function donneNomU(){var res='';var nom=window.opener.parent.APIgetValue("cmi.learner_name");var indexVirg=nom.indexOf(',');if (indexVirg>0){res=nom.substring(0,indexVirg);} else {res=nom;} return res;}function donneScoreAtteint(){return window.opener.localeNb(window.opener.parent.oSco.evaluation.scoreAtteint);}function donneScoreAtteint(){return window.opener.localeNb(window.opener.parent.oSco.evaluation.scoreAtteint);}function donnePcAtteint(){return window.opener.localeNb(window.opener.parent.oSco.evaluation.pourcentageAtteint);}
