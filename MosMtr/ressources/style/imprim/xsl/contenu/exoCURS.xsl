<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"> <xsl:import href="../../../../../../../../MosGnr/xsl/export/GEN_vImprim.xsl" /> <xsl:template name="exoCURS"> <div class="STY_question"> <xsl:apply-templates select="exo/question" /> </div> <div class="STY_texteCURS"> <xsl:apply-templates select="exo/texteCurseur" /> </div> <xsl:if test="exo/interactions/*"> <div class="STY_zoneCommentaire"> <xsl:call-template name="COMMENTAIRES_EXO" /> </div> </xsl:if> </xsl:template> <xsl:template match="/"> <xsl:call-template name="ENTETE_PAGE" /> <xsl:call-template name="STYLE_contenu" /> <xsl:call-template name="exoCURS" /> <xsl:call-template name="BAS_PAGE" /> </xsl:template> <xsl:template match="curseur"> <xsl:variable name="idC" select="@id" /> <div> <xsl:copy-of select="@style" /> <div style="position:relative;" id="divEchelle{$codePage}{@id}"> <img id="imgEchelle{$codePage}{@id}"> <xsl:attribute name="src">../../MosMtr/ressources/style/imprim/media/curs_<xsl:value-of select="@vertical" />e.png</xsl:attribute> <xsl:if test="@imgW!=''"> <xsl:attribute name="width"> <xsl:value-of select="@imgW" /> </xsl:attribute> </xsl:if> <xsl:if test="@imgH!=''"> <xsl:attribute name="height"> <xsl:value-of select="@imgH" /> </xsl:attribute> </xsl:if> </img> <br /> <xsl:if test="/*/@afficheCorrection='oui'"> <div style="position:absolute; z-index:15; left: 0px; top: 0px;width:20px;height:20px;cursor:pointer" class="curseurFleche" id="divCurseur{$codePage}{@id}"> <img id="imgCurseur{$codePage}{@id}"> <xsl:attribute name="src">../../MosMtr/ressources/style/imprim/media/curs_<xsl:value-of select="@vertical" />c.png</xsl:attribute> </img> </div> </xsl:if> </div> <div id="exoCURS{$codePage}{@id}labelMin"> <xsl:attribute name="class">STY_legendeCURS_<xsl:choose><xsl:when test="@vertical='1'">b</xsl:when><xsl:otherwise>g</xsl:otherwise></xsl:choose></xsl:attribute> <xsl:value-of select="@valMin"/><xsl:value-of select="@unite" /><xsl:if test="@labelMin!=''">&#160;&#8211;&#160;<xsl:value-of select="@labelMin" /></xsl:if> </div> <div id="exoCURS{$codePage}{@id}labelMax"> <xsl:attribute name="class">STY_legendeCURS_<xsl:choose><xsl:when test="@vertical='1'">h</xsl:when><xsl:otherwise>d</xsl:otherwise></xsl:choose></xsl:attribute> <xsl:value-of select="@valMax"/><xsl:value-of select="@unite" /><xsl:if test="@labelMax!=''">&#160;&#8211;&#160;<xsl:value-of select="@labelMax" /></xsl:if> </div> <xsl:if test="@afficheCompteur='1'"> <div id="divCompteur{$codePage}{@id}" class="STY_compteurCURS_{@vertical}"> <xsl:choose> <xsl:when test="/*/@afficheCorrection='oui'"> <xsl:value-of select="@valInit" /> </xsl:when> <xsl:otherwise> <span style="padding-left:17px"> </span> <xsl:value-of select="@unite" /> </xsl:otherwise> </xsl:choose> </div> </xsl:if> </div> <xsl:if test="not (/*/@afficheCorrection='non')"> <script type="text/javascript"> <xsl:if test="//reponse[(@ref=$idC) and (@styleR='nw')]">var oDivCurseur=PF_donneObjet('divCurseur<xsl:value-of select="$codePage" /><xsl:value-of select="@id" />');var oDivZone=PF_donneObjet('divEchelle<xsl:value-of select="$codePage" /><xsl:value-of select="@id" />');var oCurs=PF_donneObjet('imgCurseur<xsl:value-of select="$codePage" /><xsl:value-of select="@id" />');var oEchelle=PF_donneObjet('imgEchelle<xsl:value-of select="$codePage" /><xsl:value-of select="@id" />');var min=<xsl:value-of select="//reponse[(@ref=$idC) and (@styleR='nw')]/@min" />;var max=<xsl:value-of select="//reponse[(@ref=$idC) and (@styleR='nw')]/@max" />;var moy=(max-min)/2+min;var valR=moy-Number(<xsl:value-of select="@valMin" />);var valFin=<xsl:value-of select="@valMax" />-Number(<xsl:value-of select="@valMin" />);<xsl:choose><xsl:when test="@vertical='1'">var tailleEchelle=oEchelle.height; var valPx=Math.round((valR/valFin) * tailleEchelle);oDivCurseur.style.top=Number(tailleEchelle-valPx-oCurs.height/2)+'px'; var valBorne=Math.round(((min-Number(<xsl:value-of select="@valMin" />))/valFin) * tailleEchelle);var pos='top:'+Math.round(tailleEchelle-valBorne)+'px';oDivZone.innerHTML+='\x3Cdiv class="STY_borneMin1" style="position:absolute;left:0px;'+pos+'"\x3E\x3C/div\x3E';valBorne=Math.round(((max-Number(<xsl:value-of select="@valMin" />))/valFin) * tailleEchelle);pos='top:'+Math.round(tailleEchelle-valBorne)+'px';oDivZone.innerHTML+='\x3Cdiv class="STY_borneMax1" style="position:absolute;left:0px;'+pos+'"\x3E\x3C/div\x3E';</xsl:when><xsl:otherwise>var tailleEchelle=oEchelle.width;var valPx=Math.round((valR/valFin) * tailleEchelle);oDivCurseur.style.left=Number(valPx-oCurs.width/2)+'px';var valBorne=Math.round(((min-Number(<xsl:value-of select="@valMin" />))/valFin) * tailleEchelle);var pos='left:'+valBorne+'px';oDivZone.innerHTML+='\x3Cdiv class="STY_borneMin0" style="position:absolute;top:0px;'+pos+'"\x3E\x3C/div\x3E';valBorne=Math.round(((max-Number(<xsl:value-of select="@valMin" />))/valFin) * tailleEchelle);pos='left:'+valBorne+'px';oDivZone.innerHTML+='\x3Cdiv class="STY_borneMax0" style="position:absolute;top:0px;'+pos+'"\x3E\x3C/div\x3E';</xsl:otherwise></xsl:choose>PF_modifTexteDiv('divCompteur<xsl:value-of select="$codePage" /><xsl:value-of select="@id" />',moy+'<xsl:value-of select="@unite" />');</xsl:if> </script> </xsl:if> </xsl:template> <xsl:template match="consigne"><td class="STY_commentaire" valign="top"> <div class="STY_comtTitre"> <xsl:if test=".//img or .//clipAV"><xsl:attribute name="style">display:block;margin-bottom:3px</xsl:attribute></xsl:if> <xsl:choose><xsl:when test="@titre"> <xsl:value-of select="@titre"/> </xsl:when><xsl:otherwise><lex id="12"/></xsl:otherwise></xsl:choose><xsl:if test="not(@titre='') and not(p or div or img or clipAV or table)">.</xsl:if></div> <div class="STY_comtContenu"><xsl:apply-templates /></div></td></xsl:template><xsl:template match="exo//commentaire"><td class="STY_commentaire" valign="top"><xsl:if test="not(/*/@afficheCorrection='non')"> <div class="STY_comtTitre"> <xsl:if test=".//img or .//clipAV"><xsl:attribute name="style">display:block;margin-bottom:3px</xsl:attribute></xsl:if> <xsl:choose><xsl:when test="@num and @num!=''"><xsl:value-of select="@num" />. <xsl:value-of select="@titre" /></xsl:when><xsl:otherwise> <xsl:choose><xsl:when test="@titre"> <xsl:value-of select="@titre"/> </xsl:when><xsl:otherwise><lex id="131"/></xsl:otherwise></xsl:choose></xsl:otherwise></xsl:choose><xsl:if test="not(@titre='') and not(p or div or img or clipAV or table)">.</xsl:if></div> <div class="STY_comtContenu"><xsl:apply-templates /></div> </xsl:if></td></xsl:template><xsl:template match="suggestion"><td class="STY_commentaire" valign="top"><xsl:if test="not(@ref='[solution]') or not(/*/@afficheCorrection='non')"> <div class="STY_comtTitre"> <xsl:if test=".//img or .//clipAV"><xsl:attribute name="style">display:block;margin-bottom:3px</xsl:attribute></xsl:if> <xsl:choose><xsl:when test="@titre"> <xsl:value-of select="@titre"/> </xsl:when><xsl:otherwise> <xsl:choose><xsl:when test="@ref='[solution]'"><lex id="311"/></xsl:when> <xsl:otherwise><lex id="196"/></xsl:otherwise></xsl:choose> </xsl:otherwise></xsl:choose><xsl:if test="not(@titre='') and not(p or div or img or clipAV or table)">.</xsl:if></div> <div class="STY_comtContenu"><xsl:apply-templates /></div> </xsl:if></td></xsl:template></xsl:stylesheet>
