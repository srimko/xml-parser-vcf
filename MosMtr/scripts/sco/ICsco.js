var version_MosMtr="R1 039.5";var oSco; var lexique; var temps0=-1;var temps_session='';var allerEtapeSuivante=false;var allerEtapePrecedente=false;var RACINE_stage;var RACINE_pages;var surMosLMS=false;var agirSurLMS=true; var API=null; var etatSortie=false; var positionGloDetail="";var rechargePage=true;var pagePrecHisto="";var defilContenu=false;var necessiteLMS=false;var tempsActiviteLimite=0;var conserveAutresNotes="";var dernierePageLance="";var scorm4ed=false;function SCO_init(){entrerDonnees();var depuisSCOPere=false;if (SCO_donneParam("api")=="0"){depuisSCOPere=true;}var depuisLienFenetreCertifie=false;if (depuisSCOPere){agirSurLMS=false;var estStyleDiff=true;var pereEstLienFen=false;var decalDouble=0;try {var oPere=window.opener;if (oPere.oSco){depuisLienFenetreCertifie=true;}if (oPere.oSco.posFenLocale==oSco.posFenLocale){estStyleDiff=false;}if (oPere.agirSurLMS==false){if (oPere.opener!=null && oPere.opener.oSco!=null){decalDouble=40;}}} catch(e){}if (estStyleDiff || decalDouble>0){var tabP=oSco.posFenLocale.split(",");var haut=0;var gauche=0;if (tabP[0].indexOf("left=")==0){gauche=tabP[0].substring(5);}if (tabP[1].indexOf("left=")==0){gauche=tabP[1].substring(5);}if (tabP[0].indexOf("top=")==0){haut=tabP[0].substring(4);}if (tabP[1].indexOf("top=")==0){haut=tabP[1].substring(4);}window.moveTo(parseInt(gauche)+decalDouble,parseInt(haut)+decalDouble);if (estStyleDiff){window.resizeTo(parseInt(tabP[2].substring(6)),parseInt(tabP[3].substring(7)));}}}testerConfig();var strLoc=this.location.href;var indexD=strLoc.indexOf("sco/"+oSco.identifiant);if (indexD<0){indexD=strLoc.indexOf("sco\\"+oSco.identifiant);}RACINE_stage=strLoc.substring(0,indexD);RACINE_pages=RACINE_stage+"contenu/pages/";lexique = new ICLexique();lexique.init();LEX_entrerLexs(); try {if (parent.API_1484_11!=null&&parent.haut!=null){surMosLMS=true; }} catch(e){}var scorm12mode=false;if (surMosLMS){try {if (parent.haut!=null && parent.updateSCORM12){scorm12mode=true; }} catch(e){}}if (scorm12mode){necessiteLMS=false;}if (agirSurLMS){APIinitialize();if (APIisRunning()!="true"){agirSurLMS=false;} else {oSco.idUtil=APIgetValue("cmi.learner_id");if (APIgetValue("adl.data._children").indexOf("store")>=0){scorm4ed=true;}}if (necessiteLMS && surMosLMS && !parent.SUR_CHORUS){if (!existeFenPere(window.parent)){if (oSco.version=="xml"||parent.location.href.indexOf("start.hta")<0){oSco=null;agirSurLMS=false;parent.LMS_masquerCadres();alert("Error 57. LMS not found.\nThis course is not allowed to run standalone.");return parent.LMS_fermer();}} else if (oSco.version=="html" && !parent.opener.DOMPrefs && !(parent.opener.parent && parent.opener.parent.contenu)){oSco=null;agirSurLMS=false;parent.LMS_masquerCadres();alert("Error 58. LMS not found.\nThis course is not allowed to run standalone.");return parent.LMS_fermer();}}}if (!agirSurLMS){if (necessiteLMS && !depuisLienFenetreCertifie){if (oSco.version=="html"){return alert("Error 55. LMS not found.\nThis course is not allowed to run standalone.");} else {if (!existeFenPere(window)){var iframeChorus=false;try {if (top.oZoneContenu && top.document.getElementsByTagName("iframe").length>0){iframeChorus=true;}} catch(e){}if (!iframeChorus){return alert("Error 56. LMS not found.\nThis course is not allowed to run standalone.");}}}}var cstg=SCO_donneParam("stg");if (cstg!=""){oSco.codeStage=cstg;}}if (agirSurLMS){var launch_data=APIgetValue("cmi.launch_data");if (launch_data!=""){oSco.tabDonneesDemarrage=launch_data.split("[;]");if (oSco.donneeLMS("autoriserReprise")=="oui"){oSco.autoriserReprise=true;}if (oSco.donneeLMS("passageEntreActivites")=="non"){oSco.passageEntreActivites=false;}}}oSco.penaliserMauvaiseReponse=oSco.scoreNegatif;if (oSco.etatEvaluation){oSco.evaluation.init();}var numPremierePage=0;var nbPages=oSco.tabPages.length;var idPg=SCO_donneParam("idPg");var directionVersPrecedent=false;if (idPg=="" && oSco.autoriserReprise && agirSurLMS){var depuisBtnPrec=SCO_donneAllocation("depuisBtnPrec","course");if (depuisBtnPrec=="oui"){SCO_modifAllocation("depuisBtnPrec","","course");if (nbPages>1 && APIgetValue('cmi.entry')!='resume'){if (!oSco.etatEvaluation || oSco.evaluation.questions.length>0){if (oSco.autorisePrecedent=='oui' || (!oSco.etatEvaluation && oSco.autorisePrecedent=='')){numPremierePage=nbPages-1;directionVersPrecedent=false;}}}}}if (idPg!=""){numPremierePage=oSco.numeroPage(idPg);if (numPremierePage<0){numPremierePage=0;}} else {if (oSco.autoriserReprise && APIgetValue('cmi.entry')=='resume'){var tabParmSusp=APIgetValue("cmi.suspend_data").split("##");for (var i=0;i<tabParmSusp.length;i++){if (tabParmSusp[i].indexOf("visitedPages=")==0){var laSel=tabParmSusp[i].substring(13);var nouveauTab=new Array();var tabPagesSusp=laSel.split("[;]");for (var n=0;n<tabPagesSusp.length;n++){if (tabPagesSusp[n]!=""){var oPg=oSco.donnePage(oSco.numeroPage(tabPagesSusp[n]));if (oPg!=null){oPg.etatVisite=true;}}}}}idPg=APIgetValue('cmi.location');if (idPg!=''){numPremierePage=oSco.numeroPage(idPg);}} } if (agirSurLMS){ if (SCO_enregistrerEtatEntrainement()){if (SCO_donneAllocation(oSco.identifiant+"_success_status","course")=="passed"){oSco.dejaReussi=true;}} } if (nbPages>1 && oSco.autoriserReprise){ valeurExit('suspend'); } else {valeurExit('');} if (numPremierePage<0){numPremierePage=0;}if (agirSurLMS){ if (APIgetValue("cmi.entry")=="ab-initio"){ APIsetValue("cmi.completion_status","not attempted"); var valMemoEtat=SCO_donneMemoEtatParcours(); if (valMemoEtat!="non_trouve" && valMemoEtat!=""){ var tabAct=valMemoEtat.split("[,]"); for (var k=0;k<tabAct.length;k++){ if (tabAct[k].indexOf(oSco.identifiant+"#")==0){ var tabPrm=tabAct[k].split("#"); if (tabPrm[1]!=""){APIsetValue("cmi.completion_status",tabPrm[1]);} if (tabPrm[2]!=""){APIsetValue("cmi.progress_measure",tabPrm[2]);} if (tabPrm[3]!=""){APIsetValue("cmi.success_status",tabPrm[3]);} if (tabPrm[4]!=""){APIsetValue("cmi.score.scaled",tabPrm[4]);} } } }} var valMaxTA=APIgetValue("cmi.max_time_allowed"); if (valMaxTA!=""){ var intv=intervalleEnMS(valMaxTA); if (APIgetValue("cmi.entry")=="resume"){ var dejaPris=intervalleEnMS(APIgetValue("cmi.total_time")); intv=intv-dejaPris; if (intv<100){intv=100;} } tempsActiviteLimite=intv; setTimeout(SCO_tempsDepasse,intv); changeObjectifSecondaire("EXIT_ON_TIMEOUT","failed"); } if (!oSco.etatEvaluation){ var valSeuilCp=APIgetValue("cmi.completion_threshold"); if (valSeuilCp!=""){ oSco.niveauComplete=Number(valSeuilCp)*100; } } }SCO_demarreCompteur();var leBonNum=numPremierePage;var oPage=oSco.donnePage(numPremierePage);if (oPage==null){leBonNum=0;oPage=oSco.tabPages[0];}if (oSco.etatEvaluation && oSco.evaluation.etatRejoue){window.contenu.location.replace(RACINE_stage+"contenu/local/"+oSco.evaluation.stylePgResultats+"."+oSco.version);} else {if (idPg=="" && !oPage.validePrerequis()){if (directionVersPrecedent){SCO_pagePrecedente();} else {SCO_pageSuivante();}} else {SCO_allerPage(leBonNum);}}}function testerConfig(){var verStr=navigator.appVersion;var app=navigator.appName;var versionNavig = parseFloat(verStr);if (verStr.indexOf("Win") > 0) {oSco.config_plateforme="WIN";}if (verStr.indexOf("Mac") > 0) {oSco.config_plateforme="MAC";}if (app.indexOf('Microsoft') != -1) { oSco.config_navigateur="IE"; } else if (app.indexOf('Netscape') != -1 || app=="Opera") { oSco.config_navigateur="Netscape"; }}function SCO_enrHistorique(){var oPage=oSco.donnePage(oSco.numPageCourante);if (oPage!=null){if (oPage.etatVisite){oPage.premiereVisite=false;}oPage.etatVisite=true;} }function SCO_quitter(){if (agirSurLMS && APIisRunning()){if (oSco.autoriserReprise){SCO_positionSortie();}if (oSco.evaluation && !oSco.evaluation.estJugee && oSco.autorisePrecedent=='oui'){var toutRepondu=true;for (var i=0;i<oSco.tabPages.length;i++){var oPage=oSco.tabPages[i];if (oPage.estExercice()){if (oSco.evaluation.donneReponsesQuestion(oPage.code)==null){toutRepondu=false;}}}if (toutRepondu){valeurExit("normal");oSco.evaluation.juger();oSco.evaluation.resultatsLMS();APIcommit();}}SCO_terminer(); }}function SCO_terminer(){if (agirSurLMS && APIisRunning()){ SCO_termineCompteur();var valMemoEtat=SCO_donneMemoEtatParcours(); if (valMemoEtat!="non_trouve"){ var tabAct=valMemoEtat.split("[,]"); for (var k=0;k<tabAct.length;k++){ if (tabAct[k].indexOf(oSco.identifiant+"#")==0){ tabAct.splice(k,1);break; } } var actCour=oSco.identifiant+"#"+APIgetValue("cmi.completion_status")+"#"+APIgetValue("cmi.progress_measure")+"#"+APIgetValue("cmi.success_status")+"#"+APIgetValue("cmi.score.scaled"); tabAct.push(actCour); var resustr=""; for (var k=0;k<tabAct.length;k++){ if (resustr!=""){resustr+="[,]"}; resustr+=tabAct[k]; } SCO_modifAllocation("MosMemoEtatParcours",resustr,"course"); } APIterminate(); }}function SCO_pageSuivante(){if (allerEtapeSuivante){valeurExit("normal");APIsetValue("adl.nav.request","continue");SCO_terminer();} else {SCO_termineCompteur();SCO_allerPage(SCO_numPageSuivante(false));}}function SCO_numPageSuivante(enArriere){var ajDir=1;if (enArriere){ajDir=-1;}var numChe=oSco.numPageCourante+ajDir;var trouve=false;var oPage=oSco.donnePage(numChe);while (oPage!=null &&!trouve){trouve=oPage.validePrerequis();if (!trouve){numChe+=ajDir;oPage=oSco.donnePage(numChe);}}if (!trouve){numChe=-1;}return numChe;}function SCO_allerPage(num){var oPage=oSco.donnePage(num);if (oPage!=null){oSco.numPageCourante=num;allerEtapePrecedente=false;allerEtapeSuivante=false;var titrefens=oSco.titre;if (oPage.dateMAJ!=""){titrefens=oPage.titre;if (oSco.nombrePages()>1){if (oSco.titre!=oPage.titre){titrefens=oSco.titre+" - "+oPage.titre;}}}dernierePageLance="";window.document.title=titrefens;window.contenu.location.replace(RACINE_pages+oPage.code+"."+oSco.version+ajouteAleatoireCache());}}function ajouteAleatoireCache(){if (oSco.version=="xml" && parent.opener){try {if (parent.opener.top.menu && parent.opener.top.menu.NOM_CREATEUR=="MOS Chorus"){return "?rand="+Math.round(Math.random()*10000);}} catch(e){}}return "";}function SCO_evaluerCompletion(){var nMax=0;var nbVisite=0;for (var j=0;j<oSco.tabPages.length;j++){if (oSco.tabPages[j].validePrerequis()){nMax++;if (oSco.tabPages[j].etatVisite){nbVisite++;if (oSco.etatEvaluation && !oSco.evaluation.forcerRepQuestion && oSco.tabPages[j].estExercice()){if (oSco.evaluation.donneReponsesQuestion(oSco.tabPages[j].code)==null){nbVisite--;}}}}}var pcvisite=Math.round(nbVisite/nMax*100);var nivPrec=APIgetValue("cmi.progress_measure");if (!nivPrec || Number(nivPrec)<(pcvisite/100)){var nivv=pcvisite/100;APIsetValue("cmi.progress_measure",nivv.toFixed(5));}if (APIgetValue("cmi.completion_status")=="completed"){return;}var nEtat="";if (pcvisite>=oSco.niveauIncomplet){nEtat="incomplete";}if (pcvisite>=oSco.niveauComplete && (!oSco.etatEvaluation||estPageQCResultat())){nEtat="completed";}if (nEtat!=""){if (nEtat=="completed"&&pcvisite<100){APIsetValue("cmi.progress_measure","1");}APIsetValue("cmi.completion_status",nEtat);if (nEtat=="completed" && (!oSco.etatEvaluation||estEvalSansResultat())){APIsetValue("cmi.success_status","passed");if (SCO_enregistrerEtatEntrainement()){SCO_modifAllocation(oSco.identifiant+"_success_status","passed","course");}}if (nEtat=="completed"){APIcommit();}}}function SCO_pagePrecedente(){if (allerEtapePrecedente){if (!oSco.etatEvaluation || !oSco.autoriserReprise){valeurExit("normal");}if (oSco.autoriserReprise){SCO_modifAllocation("depuisBtnPrec","oui","course");}var res=APIsetValue("adl.nav.request","previous");SCO_terminer();} else {SCO_allerPage(SCO_numPageSuivante(true));}}function SCO_suivantPossible(){var possible=true;var dernierePage=false;if (oSco.evaluation!=null){if (oSco.evaluation.numPageSuivante()<0){dernierePage=true;if (oSco.evaluation.peutAllerPageResultats()){dernierePage=false;}}} else {if (SCO_numPageSuivante(false)<0){dernierePage=true;}}if (dernierePage){if (oSco.passageEntreActivites && agirSurLMS && APIgetValue("adl.nav.request_valid.continue")=="true"){possible=true;allerEtapeSuivante=true;} else {possible=false;}}return possible;}function SCO_precedentPossible(){var res=false;if (oSco.numPageCourante>0){res=true;if (SCO_numPageSuivante(true)<0){res=false;}}if (!res) {if (oSco.passageEntreActivites && agirSurLMS && APIgetValue("adl.nav.request_valid.previous")=="true"){res=true;allerEtapePrecedente=true;}}return res;}function SCO_demarreCompteur() { var oDate = new Date(); temps0=oDate.getTime();}function SCO_termineCompteur() { if (temps0>0) { var temps1 = new Date().getTime(); var elapsedSeconds = parseInt(((temps1 - temps0)/1000)); temps_session = formaterSecondes(elapsedSeconds); APIsetValue("cmi.session_time",temps_session); }}function formaterSecondes(ts){ var sec = (ts % 60); ts -= sec; var tmp = (ts % 3600); ts -= tmp; sec = Math.round(sec); var hour,min; if ((ts % 3600) != 0 ) hour = 0; else hour = (ts / 3600); if ( (tmp % 60) != 0 ) min = 0; else min = (tmp / 60); return intervalleTemps(hour,min,sec);}function intervalleEnMS(t){ var strTemps=new String(t); strTemps=strTemps.substring(strTemps.indexOf('T')+1); var indY=strTemps.indexOf("H"); var heures=0; if (indY>0){ heures=parseInt(strTemps.substring(0,indY),10); strTemps=strTemps.substring(indY+1); } indY=strTemps.indexOf("M"); var min=0; if (indY>0){ min=parseInt(strTemps.substring(0,indY),10); strTemps=strTemps.substring(indY+1); } indY=strTemps.indexOf("S"); var sec=0; if (indY>0){ sec=parseInt(strTemps.substring(0,indY),10); } return ((heures*3600)+(min*60)+sec)*1000;}function SCO_positionSortie(){var page=oSco.donnePage(oSco.numPageCourante);if (page!=null){APIsetValue("cmi.location",page.code);} else {APIsetValue("cmi.location","");}var lesids="[;]";for (var n=0;n<oSco.tabPages.length;n++){if (oSco.tabPages[n].etatVisite){lesids+=oSco.tabPages[n].code+"[;]";}}var suspend=APIgetValue("cmi.suspend_data");if (suspend!=""){var inVs=suspend.indexOf("visitedPages=");if (inVs==0){suspend="";}else if (inVs>0){suspend=suspend.substring(0,inVs);} else {suspend+="##";}}APIsetValue("cmi.suspend_data",suspend+"visitedPages="+lesids);}function valeurExit(val){ APIsetValue("cmi.exit",val);}function SCO_titrePageSuivante(){var res='';var page=oSco.donnePage(oSco.numPageCourante+1);if (page!=null){res=page.titre;}return res;}function SCO_titrePagePrecedente(){var res='';var page=oSco.donnePage(oSco.numPageCourante-1);if (page!=null){res=page.titre;}return res;}var idMotCherche;function donneIdMotCherche(){return idMotCherche;}function SCO_afficherMotGlossaire(idMotGloss){var largeur,hauteur,gauche,haut;if (positionGloDetail==""){gauche=50;haut=50;largeur = 300;hauteur = 300;} else {var tabParm=positionGloDetail.split(",");gauche=tabParm[0];haut=tabParm[1];largeur = tabParm[2];hauteur = tabParm[3];}var position="left="+gauche+",top="+haut+",width="+largeur+",height="+hauteur+",";idMotCherche=idMotGloss;var nFen=oSco.codeStage;nFen=nFen.replace(/[- \.\/:]/g,'_');var locGFlo=RACINE_stage;var verss=oSco.version;if (oSco.refGlo!=''){locGFlo=RACINE_stage+"../"+oSco.refGlo+"/";verss=oSco.refGloExt;}var ajRand="";var refFin=locGFlo+"contenu/glossaire/glossaire."+verss+ajouteAleatoireCache();if (oSco.glossaireSurPage!=""){return window.contenu.GEN_afficherGlossaireSurPage(refFin,oSco.glossaireSurPage);}var fenGloDetail=window.open(refFin,'GlossaireDetail'+nFen,'toolbar=no,status=no,menubar=no,'+position+'scrollbars=no,resizable=yes');fenGloDetail.focus();}function SCO_urlDuDocument(code,type){var srcD;if (type=='REFERENCE'){var addr=oSco.csSCO_paramDoc(code,3);if (addr.match(/^\w+:/)==null){addr=RACINE_stage+addr;}srcD=addr;} else {srcD=RACINE_stage+'contenu/pages/'+oSco.csSCO_paramDoc(code,2)+"."+type;}return srcD;}function SCO_paraFenDuDocument(code){var pos=oSco.csSCO_paramDoc(code,1);if (pos.indexOf('inclus')==0){return "inclus";}var largeur;var hauteur;var decalx = 0;var decaly = 0;if (pos!=''){var tabP=pos.split(',');decalx=parseInt(tabP[1]);if (isNaN(decalx)){decalx=0;}else if (decalx<0){decalx=screen.width+decalx;}decaly=parseInt(tabP[2]);if (isNaN(decaly)){decalx=0;}else if (decaly<0){decaly=screen.height+decaly;}largeur=tabP[3];hauteur=tabP[4];} else {largeur=screen.width;hauteur=screen.height;}var position="width="+largeur+",height="+hauteur+",left="+decalx+",top="+decaly;var optMenubar=oSco.csSCO_paramDoc(code,4);if (optMenubar=="null"){return "null";}if (optMenubar.indexOf("scrollbars")<0){optMenubar+=",scrollbars=yes";}if (optMenubar.indexOf("resizable")<0){optMenubar+=",resizable=yes";}if (optMenubar.indexOf("toolbar")<0){optMenubar+=",toolbar=no";}if (optMenubar.indexOf("menubar")<0){optMenubar+=",menubar=no";}if (optMenubar.indexOf("status")<0){optMenubar+=",status=no";}if (optMenubar.indexOf("location")<0){optMenubar+=",location=no";}if (optMenubar.indexOf(",")!=0){optMenubar=","+optMenubar;}return position+optMenubar;}function SCO_ouvrirDoc(code,type){var srcD=SCO_urlDuDocument(code,type);var pos=SCO_paraFenDuDocument(code);if (pos=="inclus"){var afficheSimple=true;if (APIgetValue("adl.nav.request_valid."+SCO_actionAllerA()+".{target="+code+"}")=="true"){APIsetValue("adl.nav.request","{target="+code+"}"+SCO_actionAllerA());afficheSimple=false;SCO_quitter();}if (afficheSimple){window.contenu.location.replace(srcD);} } else {if (pos=="null"){window.open(srcD);} else {var fenDoc=window.open(srcD,"fenDoc"+code,pos);fenDoc.focus();}}}function titreFenDoc(nom){try{fenDoc.document.title=nom;}catch(e){}}function donneLex(num){return lexique.lexs[num];}function donneTitreStage(){return oSco.titreStage;}function donneLangue(){return oSco.langue;}function donneNomModuleCourant(){return oSco.nomModuleCourant;} function donneNomUtilisateur(){var res='';var nom=APIgetValue("cmi.learner_name");var indexVirg=nom.indexOf(',');if (indexVirg>0 && nom.length>2){res=nom.substring(indexVirg+1,nom.length)+' '+nom.substring(0,indexVirg);} return res;}function donneDateCourante(){return oSco.donneDate(oSco.dateCourante);}function donneDroits(){return oSco.nomEntreprise;}function donneVersion(){return oSco.version;}function donneNomEtapeCourante(){return oSco.titre;}function SCO_tempsDepasse(){tempsActiviteLimite=0;var activeLimite=true;if (oSco.etatEvaluation){if (oSco.evaluation.etatCorrige || window.contenu.location.href.indexOf("local/resultats")>0){ activeLimite=false;}}if (activeLimite){oSco.tempsDepasseEvt=true;var actionFin=APIgetValue("cmi.time_limit_action");if (actionFin.indexOf("exit")==0){SCO_termineCompteur();temps0=0; }var actionPerso="";if (oSco.donneeLMS("actionPersoTempsLimite")!=""){actionPerso=oSco.donneeLMS("actionPersoTempsLimite");}if (actionFin.indexOf("exit")==0){if (actionPerso==""){actionPerso="exitAll";}if (actionPerso=="exitAll"){valeurExit("time-out");}else {valeurExit("");}changeObjectifSecondaire("EXIT_ON_TIMEOUT","passed");} if (actionFin.indexOf(",message")>0){var nlex=-1;if (actionPerso=="exitAll"||actionPerso=="suspendAll"||actionPerso=="abandonAll"){nlex=89;}if (actionPerso=="retry"){nlex=91;}if (actionPerso=="continue"){nlex=93;if (oSco.etatEvaluation){nlex=94;}}if (actionPerso=="previous"){nlex=92;}if (actionPerso=="exit"){nlex=90;}var msgx="";if (nlex>0){msgx=donneLex(nlex);}alert(donneLex(63)+"\n"+msgx);}if (oSco.etatEvaluation){if (actionPerso=="continue"){valeurExit("normal");oSco.evaluation.genererQuestionsRestantes();oSco.numPageCourante=oSco.tabPages.length-1;return oSco.evaluation.sortieEvaluation();}}navRequest(actionPerso);if (actionPerso!=""){setTimeout("window.location='"+RACINE_stage+"MosMtr/gen/blanc.gif'",1500);}}}function terminerSCODepuisTempParc(){if (oSco.evaluation&&!oSco.evaluation.estJugee){if (oSco.evaluation.questions.length>0){valeurExit("normal");oSco.evaluation.genererQuestionsRestantes();oSco.evaluation.juger();oSco.evaluation.resultatsLMS();APIcommit();}}}/* Classe Lexique */function ICLexique() { this.lexs; this.init = LEXO_init; this.ajLex = LEX_ajouterLex;}function LEXO_init(){this.lexs=new Array();}function LEX_ajouterLex(id,lex){this.lexs[id]=lex;}function SCO_donneParam(nomP){ var params=window.location.search; if (params!="" && params.indexOf('%26')>0){params=params.replace(/%26/,'&');} var ind=params.indexOf(nomP+'='); if (ind>0){ var reste=params.substring(ind+nomP.length+1); var indexFin=reste.indexOf('&'); if (indexFin<0){indexFin=params.length;} return reste.substring(0,indexFin); } return "";}function intervalleTemps(strHour, strMin, strSec){var strTime = "P";var intHour=parseInt(strHour,10);var intMin=parseInt(strMin,10);var intSec=parseInt(strSec,10); if (intHour>0 || intMin>0 || intSec>0){ strTime += "T"; if (intHour> 0)strTime += intHour + "H"; if (intMin> 0)strTime += intMin + "M"; if (intSec> 0 ){strTime += ( intSec + "S");}} if (strTime == "P") strTime = "PT0H0M0S"; return strTime;}function SCO_enregistrerEtatEntrainement(){return (oSco.bloquantSaufAcheve && oSco.exoBloquant=="oui" && oSco.evaluation==null);}function SCO_exerciceBloquant(){if (oSco.exoBloquant!="oui"){return false;}if (oSco.bloquantSaufAcheve && oSco.dejaReussi){return false;}return true;}function SCO_modifAllocation(attr,val,persist){if (scorm4ed && persist=="course"){var compteAl=SCO_compteCMI("adl.data");for (var i=0;i<compteAl;i++){if (APIgetValue("adl.data."+i+".id")==attr){return APIsetValue("adl.data."+i+".store",val);}}}var tailleRequis=2000;if (attr.indexOf("_notesU")>0||attr.indexOf("_reponses")>0){tailleRequis=20000;}if (val.length*2 > tailleRequis){tailleRequis=val.length*3;}var succ=APIsetValue("ssp.allocate","{bucketID="+attr+"}{requested="+tailleRequis+"}{persistence="+persist+"}");if (succ!="true"){window.status="Can't allocate SSP variable";return "";}succ=APIsetValue("ssp.data","{bucketID="+attr+"}"+val);if (succ!="true"){alert(" Can't assign SSP variable "+attr);var hAPI=APIgetHandle();alert(hAPI.GetDiagnostic(hAPI.GetLastError()));}}function SCO_donneAllocation(attr,persist){if (scorm4ed && persist=="course"){var compteAl=SCO_compteCMI("adl.data");for (var i=0;i<compteAl;i++){if (APIgetValue("adl.data."+i+".id")==attr){return APIgetValue("adl.data."+i+".store");}}}var tailleRequis=2000;if (attr.indexOf("_notesU")>0||attr.indexOf("_reponses")>0){tailleRequis=20000;}var succ=APIsetValue("ssp.allocate","{bucketID="+attr+"}{requested="+tailleRequis+"}{persistence="+persist+"}");if (succ!="true"){window.status="Can't allocate SSP variable";/*var hAPI=APIgetHandle();alert(hAPI.GetDiagnostic(hAPI.GetLastError()));*/return "";}return APIgetValue("ssp.data.{bucketID="+attr+"}");}function SCO_actionAllerA(){if (scorm4ed){return "jump";}return "choice";}function navRequest(actionPerso){if (actionPerso=="retry"){valeurExit('');APIsetValue("adl.nav.request","{target="+oSco.identifiant+"}"+SCO_actionAllerA());SCO_terminer();}if (actionPerso=="continue" || actionPerso=="previous"){if (APIgetValue("adl.nav.request_valid."+actionPerso)=="true"){APIsetValue("adl.nav.request",actionPerso);SCO_quitter();}}if (actionPerso=="suspendAll"||actionPerso=="exit"){APIsetValue("adl.nav.request",actionPerso);SCO_quitter();}if (actionPerso=="exitAll"||actionPerso=="abandonAll"){APIsetValue("adl.nav.request",actionPerso);valeurExit('');SCO_terminer();}}function SCO_blocNotes(){var oFen=window.open(RACINE_stage+"MosMtr/gen/blocNotes.htm","blocNotes","top=100,left=90,width=420,height=390,menubar=no,location=no,toolbar=no,resizable=yes,status=no");oFen.focus();}function SCO_listeNotesU(){var oFen=window.open(RACINE_stage+"MosMtr/gen/lsNotes.htm","listeNotes","top=50,left=70,width=500,height=590,menubar=no,location=no,toolbar=no,resizable=yes,status=no");oFen.focus();}function existeFenPere(obj){try {if (obj.opener!=null && obj.opener.document.title){return true;}}catch(e){}return false;}function SCO_persiste(){SCO_positionSortie();APIcommit();}function openCourseLMS(stg,idSco){try {if (!agirSurLMS && SCO_donneParam("api")=="0"){window.opener.top.openCourseLMS(stg,idSco);} else {window.opener.ouvrirParcoursID(stg,idSco);}}catch(e){alert("MOS Chorus LMS was not found.");}}function changeObjectifSecondaire(nomObj,etatSucces){var nbObj=SCO_compteCMI("cmi.objectives");for (var i=0;i<nbObj;i++){var objCh="cmi.objectives."+i+".";if (APIgetValue(objCh+"id")==nomObj){APIsetValue(objCh+"success_status",etatSucces);break;}}}function changeScoreObjectifSecondaire(nomObj,score){var nbObj=SCO_compteCMI("cmi.objectives");for (var i=0;i<nbObj;i++){var objCh="cmi.objectives."+i+".";if (APIgetValue(objCh+"id")==nomObj){APIsetValue(objCh+"score.scaled",score);break;}}}function SCO_chargerNotesSSP(){if (!oSco.notesCharge){var vNotes=SCO_donneAllocation("stg_notesU","course");if (vNotes!=""){var tabNotes=vNotes.split("[,]");for (var m=0;m<tabNotes.length;m++){var tabNp=tabNotes[m].split("[.]");if (tabNp[0]==oSco.identifiant){var oPg=oSco.donnePage(oSco.numeroPage(tabNp[1]));if (oPg){oPg.dateNotes=tabNp[4];oPg.notes=tabNp[5];}} else {if (conserveAutresNotes!=""){conserveAutresNotes+="[,]";}conserveAutresNotes+=tabNotes[m];}}}oSco.notesCharge=true;}}function SCO_compteCMI(nom){return parseInt(APIgetValue(nom+"._count"));}function SCO_donneMemoEtatParcours(){if (scorm4ed){var compteAl=SCO_compteCMI("adl.data");for (var i=0;i<compteAl;i++){if (APIgetValue("adl.data."+i+".id")=="MosMemoEtatParcours"){return APIgetValue("adl.data."+i+".store");}}}return "non_trouve";}
