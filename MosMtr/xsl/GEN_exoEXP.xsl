<?xml version="1.0" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"><xsl:template match="texteExplore//zoneLien"><xsl:variable name="clicDroit"><xsl:if test="contains(text(),'[_b2]')">oui</xsl:if></xsl:variable><div class="STY_zoneExplore" oncontextmenu="return false"><xsl:copy-of select="@id"/><xsl:if test="not(/exo/@voirZones='non')"><xsl:attribute name="onmouseover">exo.entreeSouris('<xsl:value-of select="@id"/>')</xsl:attribute><xsl:attribute name="onmouseout">exo.sortieSouris('<xsl:value-of select="@id"/>')</xsl:attribute></xsl:if><xsl:attribute name="style"><xsl:value-of select="@style"/>;background-image:url(none)</xsl:attribute><xsl:choose><xsl:when test="$clicDroit='oui'"><xsl:attribute name="oncontextmenu">exo.action('<xsl:value-of select="@id"/>');return false;</xsl:attribute><xsl:value-of select="substring-before(text(),'[_b2]')"/></xsl:when><xsl:otherwise><xsl:attribute name="onclick">exo.action('<xsl:value-of select="@id"/>')</xsl:attribute><xsl:if test="/exo/@legendes='oui' and @label"><xsl:attribute name="title"><xsl:value-of select="@label"/></xsl:attribute></xsl:if><xsl:apply-templates/></xsl:otherwise></xsl:choose></div></xsl:template><xsl:template name="JSCRIPT_CSS_EXP"><xsl:call-template name="JSCRIPT_CSS_EXO"/><script type="text/javascript" src="../../MosMtr/scripts/contenu/ClasseExerciceEXP.js"></script><script type="text/javascript">function entrerDonnees(){<xsl:if test="exo/texteExplore//clipAV[@lecteur='Flash'] and not(//texteExplore//zoneLien)">exerciceFlash=true;</xsl:if>exo = new ExerciceEXP(<xsl:value-of select="not(exo/@multi='non')"/>,<xsl:value-of select="not(exo/@voirZones='non')"/>);exo.init();exo.scoreTotal=<xsl:apply-templates select="exo/@score"/>;<xsl:for-each select="exo/texteExplore//zoneLien"><xsl:sort select="@label" order="descending"/>var oItem=new ItemReponse();oItem.init("<xsl:value-of select="translate(substring(@id,9),'ABCDFGHJKLNOPQTUVWXabcdfghjklnopqtuvwx0124578ierRImMsSz','bHOi4ph5sWlr1c2nI7LBuzgaUNv0FDXtm8SodePVqRfwGKkJMxAQjTC')"/>","<xsl:value-of select="@poids"/>","<xsl:value-of select="@objectif"/>","<xsl:value-of select="translate(@label,'ABCDFGHJKLNOPQTUVWXabcdfghjklnopqtuvwx0124578ierRImMsSz','bHOi4ph5sWlr1c2nI7LBuzgaUNv0FDXtm8SodePVqRfwGKkJMxAQjTC')"/>");exo.tabItems[exo.tabItems.length]=oItem;</xsl:for-each><xsl:if test="not(exo/@multi='oui') and exo/@poidsEnPoints='oui'">exo.poidsEnPoints=true;</xsl:if><xsl:call-template name="AFFECTE_INTERACTIONS"/>}<xsl:for-each select="//clipAV[@lecteur='Flash']">if (navigator.appName &amp;&amp; navigator.appName.indexOf("Microsoft") != -1 &amp;&amp; navigator.userAgent.indexOf("Windows") != -1) {document.write('&lt;SCRIPT LANGUAGE=VBScript\&gt; \n');document.write('on error resume next \n');document.write('Sub <xsl:value-of select="@id"/>_FSCommand(ByVal command, ByVal args)\n');document.write(' call <xsl:value-of select="@id"/>_DoFSCommand(command, args)\n');document.write('end sub\n');document.write('&lt;/SCRIPT\&gt; \n');}function <xsl:value-of select="@id"/>_DoFSCommand(command,args){try {eval(command);}catch(e){}}</xsl:for-each></script></xsl:template> </xsl:stylesheet>
